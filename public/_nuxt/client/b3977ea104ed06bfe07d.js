(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{644:function(t,e,r){"use strict";(function(t){r(51),r(152),r(38),r(43),r(15);var o=r(1),n=(r(35),r(153)),c=(r(44),r(24),r(52)),l=r(155);e.a={props:{products:{required:!0},meta:{required:!0}},components:{VueTailwindDrawer:l.a,VueTailwindModal:c.a},data:function(){var e;return e={selectedProductSide:null,confirmationAction:null,isLoading:!1,selectedProduct:null,generatedProducts:JSON.parse(JSON.stringify(this.products))},Object(n.a)(e,"selectedProduct",this.products.length?JSON.parse(JSON.stringify(this.products[0])):null),Object(n.a)(e,"selectedProductVariantKey",this.products.length?t.first(t.keys(JSON.parse(JSON.stringify(this.products[0])).variants)):null),Object(n.a)(e,"selectedSize",null),Object(n.a)(e,"selectedProductProfit",0),Object(n.a)(e,"selectedProductSizes",[]),Object(n.a)(e,"estimatedMinProfit",0),Object(n.a)(e,"estimatedMaxProfit",0),Object(n.a)(e,"selectedProductBasePrice",0),Object(n.a)(e,"calculatorTimeout",null),Object(n.a)(e,"isCalculating",!1),e},methods:{switchSides:function(){var e=t.keys(this.selectedProduct.variants[this.selectedProductVariantKey].sides),r=e.indexOf(this.selectedProductSide),o=e[r+1];this.selectedProductSide=o||t.first(e)},downloadDesign:function(){var t="".concat(this.selectedProduct.meta.name,"-").concat(this.selectedProduct.id),e="image/svg+xml",content=this.selectedProduct.variants[this.selectedProductVariantKey].sides[this.selectedProductSide].design,r=new Blob([content],{type:e}),a=document.createElement("a");a.download="(".concat(this.selectedProductSide.toUpperCase(),")").concat(t,".svg"),a.href=URL.createObjectURL(r),a.dataset.downloadurl=[e,a.download,a.href].join(":"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(function(){URL.revokeObjectURL(a.href)},1500)},publish:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.$refs.publishConfirmationModal.hide(),t.next=4,this.$store.dispatch("admin/updateCollection",{id:this.meta.id,data:{status:"approval"===this.confirmationAction?"approved":"declined"}});case 4:this.isLoading=!1;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),selectProduct:function(t){this.selectedProduct=JSON.parse(JSON.stringify(t))},_placeholderOfFirstVariantOf:function(e){var r=t.first(t.keys(e.variants));return e.variants[r].sides[this._firstPrintableAreaOf(e.variants[r].sides)].with_placeholder},_firstPrintableAreaOf:function(e){var r=t.keys(e);return t.includes(r,"front")?"front":t.head(r)},show:function(){this.$refs.drawer.show(),this.calculateProfit()},hide:function(){this.$refs.drawer.hide()},_calculateEstProfit:function(){var e=this,r=0;t.map(this.generatedProducts,function(e){t.map(e.variants,function(e){t.map(e.sizes,function(o,n){var c=t.find(e.available_sizes,function(s){return s.name==n});if(c){var l=c.base_cost,d=l*o.quantity,f=(l+o.price)*o.quantity;r+=f-d}})})});var o=r-.05*r,n=r+.05*r;this.estimatedMinProfit=o,this.estimatedMaxProfit=n,this.$nextTick(function(){e.$refs.estMinProfit&&e.$refs.estMinProfit.play(),e.$refs.estMaxProfit&&e.$refs.estMaxProfit.play()})},calculateProfit:function(){var t=this;clearTimeout(this.calculatorTimeout),this.isCalculating=!0,this.calculatorTimeout=setTimeout(function(){t._calculateEstProfit(),t.isCalculating=!1},2e3)},confirmAction:function(t){this.confirmationAction=t,this.$refs.publishConfirmationModal.show()}},computed:{productTotalPrice:function(){return this.selectedProductBasePrice+this.selectedProductProfit},hasPreviousProductOrVariant:function(){var e=t.keys(this.selectedProduct.variants),r=e[e.indexOf(this.selectedProductVariantKey)-1];return t.findIndex(this.generatedProducts,{id:this.selectedProduct.id})>0||r}},watch:{selectedProduct:{immediate:!0,handler:function(e,r){var o=this;if(e){var n=t.first(t.keys(e.variants));this.selectedProductSizes=e.variants[n].sizes,this.selectedProductVariantKey=n;var c=t.first(t.keys(this.selectedProductSizes));this.selectedProductBasePrice=t.first(e.variants[n].available_sizes).base_cost,this.selectedProductSide=this._firstPrintableAreaOf(e.variants[this.selectedProductVariantKey].sides),this.selectedProductProfit=e.variants[n].sizes[c].price,t.keys(this.selectedProductSizes).map(function(s){return o.selectedProductSizes[s].price=o.selectedProductProfit}),this.selectedProduct.variants[this.selectedProductVariantKey].sizes=this.selectedProductSizes,this._calculateEstProfit()}}},selectedProductVariantKey:{immediate:!0,handler:function(e){if(this.selectedProduct){this.selectedProductSizes=this.selectedProduct.variants[e].sizes;t.first(t.keys(this.selectedProductSizes));this.generatedProducts[t.findIndex(this.generatedProducts,{id:this.selectedProduct.id})].variants[e].sizes=this.selectedProductSizes}}},selectedProductProfit:{immediate:!0,handler:function(e){var r=this;if(this.selectedProduct){var o=t.first(t.keys(this.selectedProduct.variants));this.selectedProductSizes=this.selectedProduct.variants[o].sizes;t.first(t.keys(this.selectedProductSizes));t.keys(this.selectedProductSizes).map(function(s){return r.selectedProductSizes[s].price=e}),this.generatedProducts[t.findIndex(this.generatedProducts,{id:this.selectedProduct.id})].variants[this.selectedProductVariantKey].sizes=this.selectedProductSizes,this.calculateProfit()}}}}}}).call(this,r(32))},858:function(t,e,r){"use strict";r.r(e);var o=r(5),n=(r(15),r(1)),c=r(19),l=r(644).a,d=r(7),f={layout:"admin_dashboard",components:{CollectionPreviewDrawer:Object(d.a)(l,function(){var t=this,e=this,r=e.$createElement,o=e._self._c||r;return o("VueTailwindDrawer",{ref:"drawer",staticClass:"text-sm",attrs:{width:"100%"}},[e.isLoading?o("AreaLoader",{attrs:{fullscreen:""}}):e._e(),e._v(" "),o("VueTailwindModal",{ref:"publishConfirmationModal",attrs:{width:"30%","content-class":"rounded-none shadow-none text-gray-600"}},[o("div",{staticClass:"flex flex-col"},[o("div",{staticClass:"modal-heading border-b w-full p-4"},[o("div",{staticClass:"flex justify-between w-full items-center"},[o("div",{staticClass:"flex uppercase justify-center flex-grow"},[o("strong",[e._v("Confirmation")])])])]),e._v(" "),o("div",{staticClass:"modal-body p-4 text-center"},[e._v("Are you sure you want to "+e._s("approval"===e.confirmationAction?"publish":"decline")+" this collection?")]),e._v(" "),o("div",{staticClass:"flex modal-footer justify-between flex-shrink p-4 border-t items-center"},[o("button",{staticClass:"justify-center items-center focus:outline-none outline-none border px-3 py-2 font-bold rounded text-gray-600 border-grey-lightest hover:bg-gray-100",attrs:{type:"button"},on:{click:function(){return t.$refs.publishConfirmationModal.hide()}}},[e._v("Cancel")]),e._v(" "),o("button",{staticClass:"shadow-xl border border-white bg-primary px-8 py-2 font-bold rounded text-white hover:bg-primary-lighter",attrs:{type:"button"},on:{click:e.publish}},[e._v("Yes")])])])]),e._v(" "),o("div",{staticClass:"flex flex-grow text-gray-600 overflow-hidden"},[o("div",{staticClass:"flex flex-col flex-grow"},[o("div",{staticClass:"flex flex-grow-0 items-center border-b p-4"},[o("div",{staticClass:"flex w-4/12 uppercase font-bold"},[o("div",{staticClass:"flex flex-col items-center"},[o("div",[e._v("TOTAL ESTIMATED PROFIT")]),e._v(" "),o("div",{staticClass:"text-primary"},[e.isCalculating?o("font-awesome-icon",{attrs:{icon:["fas","spinner"],spin:""}}):e._e(),e._v(" "),e.estimatedMinProfit?o("number",{ref:"estMinProfit",attrs:{animationPaused:"",to:e.estimatedMinProfit,format:function(t){return t.formatMoney("₱ ")},duration:.4}}):e._e(),e._v(" "),e.estimatedMinProfit?o("font-awesome-icon",{attrs:{icon:["fas","minus"]}}):e._e(),e._v(" "),o("number",{ref:"estMaxProfit",attrs:{animationPaused:"",to:e.estimatedMaxProfit,format:function(t){return t.formatMoney("₱ ")},duration:.4}})],1)])]),e._v(" "),o("div",{staticClass:"flex flex-grow justify-end"},[o("div",{staticClass:"select-none cursor-pointer w-8 h-8 border rounded-full flex justify-center items-center hover:border-gray-600 hover:text-gray-700",on:{click:e.hide}},[o("font-awesome-icon",{staticClass:"text-xs",attrs:{icon:["fas","times"]}})],1)])]),e._v(" "),o("div",{staticClass:"flex flex-grow"},[o("div",{staticClass:"flex flex-col overflow-auto w-9/12"},[o("div",{staticClass:"flex flex-grow p-4"},[o("div",{staticClass:"large-thumbnail w-6/12 flex flex-col"},[o("div",{staticClass:"flex relative justify-center items-center"},[o("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{arrow: true}"}],staticClass:"absolute top-0 left-0 border rounded flex justify-center items-center w-8 h-8 hover:text-primary hover:border-primary",attrs:{type:"button",title:"Rotate"},on:{click:e.switchSides}},[o("font-awesome-icon",{attrs:{icon:["fas","sync-alt"]}})],1),e._v(" "),e.selectedProduct.variants[e.selectedProductVariantKey].sides[e.selectedProductSide].is_empty?e._e():o("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{arrow: true}"}],staticClass:"absolute bottom-0 right-0 border rounded flex justify-center items-center w-8 h-8 hover:text-primary hover:border-primary",attrs:{type:"button",title:"Download ("+e.selectedProductSide.toUpperCase()+")"},on:{click:e.downloadDesign}},[o("font-awesome-icon",{attrs:{icon:["fas","download"]}})],1),e._v(" "),o("img",{staticClass:"w-3/5",attrs:{src:e.selectedProduct.variants[e.selectedProductVariantKey].sides[e.selectedProductSide].with_placeholder}})]),e._v(" "),o("div",{staticClass:"variants flex mt-4"},e._l(e.selectedProduct.variants,function(t,r){return o("div",{key:t.id,staticClass:"flex w-1/5 cursor-pointer border border-transparent hover:border-gray-500 p-1 rounded mr-1",class:{"border-gray-500 shadow-xl":e.selectedProductVariantKey===r},on:{click:function(){return e.selectedProductVariantKey=r}}},[o("div",{staticClass:"flex flex-col w-full"},[o("img",{attrs:{src:t.sides[e._firstPrintableAreaOf(t.sides)].with_placeholder}})])])}),0)]),e._v(" "),o("div",{staticClass:"flex flex-col mt-5 flex-grow ml-4"},[o("div",{staticClass:"text-4xl"},[o("span",{staticClass:"font-bold w-full outline-none"},[e._v(e._s(e.selectedProduct.meta.name))])]),e._v(" "),o("div",{staticClass:"text-3xl leading-none py-4 flex items-center"},[o("div",{staticClass:"relative flex flex-col"},[o("div",{staticClass:"text-xs text-gray-600 uppercase font-bold mb-1"},[e._v("Base Price")]),e._v(" "),o("div",[e._v("PHP "+e._s(e.selectedProductBasePrice)+" + ")])]),e._v(" "),o("div",{staticClass:"relative flex flex-col"},[o("div",{staticClass:"text-xs text-gray-600 uppercase font-bold mb-1"},[e._v("Profit*")]),e._v(" "),o("div",{staticClass:"flex"},[o("div",[e._v("PHP ")]),e._v(" "),o("div",[e._v(e._s(e.selectedProductProfit))]),e._v(" = \n                  ")])]),e._v(" "),o("div",{staticClass:"text-white bg-primary flex flex-col font-bold px-4 py-2 rounded"},[o("div",{staticClass:"text-xs uppercase font-bold mb-1"},[e._v(e._s("sell"===e.meta.plan?"Total Selling Price":"Sell it for"))]),e._v(" "),o("div",[e._v("PHP "+e._s(e.productTotalPrice))])]),e._v(" "),"buy"===e.meta.plan?o("div",{staticClass:"text-white bg-primary flex flex-col font-bold px-4 py-2 rounded ml-2"},[o("div",{staticClass:"text-xs uppercase font-bold mb-1"},[e._v("Pay Only")]),e._v(" "),o("div",[e._v("PHP "+e._s(e.selectedProductBasePrice))])]):e._e()]),e._v(" "),o("div",[o("div",{staticClass:"font-bold"}),e._v(" "),o("div",{staticClass:"flex flex-wrap"},e._l(e.selectedProduct.variants[e.selectedProductVariantKey].sizes,function(t,i){return o("div",{key:i,staticClass:"mr-2 rounded font-bold mt-2",class:{" px-4 py-2 border hover:border-gray-600":e.selectedProductSizes[i].quantity}},[e.selectedProductSizes[i].quantity?o("div",{staticClass:"flex items-center"},[o("div",{staticClass:"text-center mr-2"},[e._v(e._s(i)+":")]),e._v(" "),o("div",[e._v(e._s(e.selectedProductSizes[i].quantity))])]):e._e()])}),0),e._v(" "),e.selectedProduct.meta.description?o("div",{staticClass:"mt-2"},[o("div",{staticClass:"w-full border rounded p-4 outine-none resize-none"},[e._v(e._s(e.selectedProduct.meta.description))])]):e._e()])])])]),e._v(" "),o("div",{staticClass:"flex border-l w-3/12"},[o("div",{staticClass:"flex flex-col w-full"},[o("div",{staticClass:"flex p-4 uppercase border-b"},[o("strong",[e._v("OTHER PRODUCTS")])]),e._v(" "),o("div",{staticClass:"overflow-auto h-full"},[o("div",{staticClass:"flex p-4 flex-wrap"},e._l(e.generatedProducts,function(t){return o("div",{key:t.id,staticClass:"flex w-6/12 p-1"},[o("div",{staticClass:"flex flex-col border rounded w-full cursor-pointer hover:border-gray-500",class:{"border-gray-500 shadow-xl":e.selectedProduct.id===t.id},on:{click:function(r){return e.selectProduct(t)}}},[o("div",{staticClass:"px-2 pt-2"},[o("img",{attrs:{src:e._placeholderOfFirstVariantOf(t)}})])])])}),0)])])])]),e._v(" "),o("div",{staticClass:"flex p-4 items-center border-t",class:{"justify-end":"declined"===e.meta.status,"justify-between":"pending"===e.meta.status}},["declined"!==e.meta.status?o("PTButton",{on:{click:function(t){return e.confirmAction("decline")}}},[e._v("DECLINE")]):e._e(),e._v(" "),"approved"!==e.meta.status?o("PTButton",{attrs:{color:"primary"},on:{click:function(t){return e.confirmAction("approval")}}},[e._v("PUBLISH")]):e._e()],1)])])],1)},[],!1,null,null,null).exports},created:function(){var t=Object(n.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("admin/getCollections");case 3:this.isLoading=!1,t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}},t,this,[[0,6]])}));return function(){return t.apply(this,arguments)}}(),data:function(){return{isLoading:!0,generatedImages:[],collectionMeta:null}},computed:Object(o.a)({},Object(c.b)({collections:"admin/collections"})),methods:{previewCollection:function(){var t=Object(n.a)(regeneratorRuntime.mark(function t(e){var r,o,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.$store.dispatch("designer/fetchDesignData",e.id);case 3:return r=t.sent,t.next=6,this.$store.dispatch("designer/generatePreview",r);case 6:o=t.sent,this.isLoading=!1,this.generatedImages=o.data,this.collectionMeta=e,this.$nextTick(function(){n.$refs.collectionPreviewDrawer.show()});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},v=Object(d.a)(f,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"sm:px-8 relative"},[t.isLoading?r("AreaLoader"):t._e(),t._v(" "),t.generatedImages.length?r("CollectionPreviewDrawer",{ref:"collectionPreviewDrawer",attrs:{products:t.generatedImages,meta:t.collectionMeta}}):t._e(),t._v(" "),r("div",[t._m(0),t._v(" "),r("div",{staticClass:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto"},[r("div",{staticClass:"inline-block min-w-full border-l border-r overflow-hidden"},[r("table",{staticClass:"min-w-full leading-normal table-fixed"},[t._m(1),t._v(" "),r("tbody",t._l(t.collections,function(col){return r("tr",{key:col.id,class:{"bg-red-100":"declined"===col.status}},[r("td",{staticClass:"px-5 py-5 border-b border-gray-200 text-sm text-center"},[r("div",{staticClass:"flex items-center"},[r("div",{staticClass:"ml-3"},[r("p",{staticClass:"text-gray-900 whitespace-no-wrap flex items-center"},[r("span",{staticClass:"relative text-xs inline-block px-3 py-1 font-semibold leading-tight mr-2",class:{"text-white":"sell"===col.plan,"text-blue-800":"buy"===col.plan}},[r("span",{staticClass:"absolute inset-0 rounded-full",class:{"bg-primary":"sell"===col.plan,"bg-blue-400":"buy"===col.plan},attrs:{"aria-hidden":""}}),t._v(" "),r("span",{staticClass:"relative uppercase"},[t._v(t._s(col.plan))])]),t._v(" "),r("a",{staticClass:"text-blue-600 hover:underline",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.previewCollection(col)}}},[r("span",[t._v(t._s(col.name))])]),t._v(" "),r("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{arrow: true}"}],staticClass:"ml-2 text-gray-400 hover:text-gray-600",attrs:{href:"#",title:"Feature this Collection"}},[r("font-awesome-icon",{attrs:{icon:["fas","star"]}})],1)])])])]),t._v(" "),r("td",{staticClass:"px-5 py-5 border-b border-gray-200 text-sm text-center"},["sell"===col.plan?r("div",{staticClass:"border bg-gray-200 w-full bg-grey-light rounded-full"},[r("div",{staticClass:"bg-primary text-xs rounded-full leading-none py-1 text-center text-white",staticStyle:{width:"45%"}},[t._v("45%")])]):r("div",[t._v("\n                  N/A\n                ")])]),t._v(" "),r("td",{staticClass:"px-5 py-5 border-b border-gray-200 text-sm text-center"},[r("span",{staticClass:"relative inline-block px-3 py-1 font-semibold leading-tight text-xs"},[r("span",{staticClass:"absolute inset-0 rounded-full",class:{"bg-green-200":"approved"===col.status,"bg-red-300":"declined"===col.status,"bg-blue-200":"pending"===col.status},attrs:{"aria-hidden":""}}),t._v(" "),r("span",{staticClass:"relative uppercase"},[t._v(t._s(col.status))])])]),t._v(" "),r("td",{staticClass:"px-5 py-5 border-b border-gray-200 text-sm text-center"},[r("div",[r("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{arrow: true}"}],staticClass:"px-2 py-1 text-xs bg-white hover:bg-gray-200 border rounded mx-1",attrs:{type:"button",title:"Delete"},on:{click:function(e){return t.showDeleteCollectionConfirmation(col)}}},[r("font-awesome-icon",{attrs:{icon:["fas","trash"]}})],1),t._v(" "),r("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{arrow: true}"}],staticClass:"px-2 py-1 text-xs bg-white hover:bg-gray-200 border rounded mx-1",attrs:{type:"button",title:"Share"}},[r("font-awesome-icon",{attrs:{icon:["fas","share-alt"]}})],1)])])])}),0)])])])])],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"my-2 flex sm:flex-row justify-between items-center"},[e("h2",{staticClass:"text-2xl font-semibold leading-tight"},[this._v("All Collections")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{staticClass:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-xs font-semibold text-gray-600 uppercase tracking-wider text-left"},[this._v("Name")]),this._v(" "),e("th",{staticClass:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-xs font-semibold text-gray-600 uppercase tracking-wider text-left"},[this._v("Progress")]),this._v(" "),e("th",{staticClass:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-xs font-semibold text-gray-600 uppercase tracking-wider text-center"},[this._v("Status")]),this._v(" "),e("th",{staticClass:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-xs font-semibold text-gray-600 uppercase tracking-wider text-center"},[this._v("Actions")])])])}],!1,null,null,null);e.default=v.exports}}]);